<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Adapting other PostgreSQL types" href="pgtypes.html" /><link rel="prev" title="Passing parameters to SQL queries" href="params.html" />

    <meta name="generator" content="sphinx-5.2.2, furo 2022.06.21"/>
        <title>Adapting basic Python types - psycopg 3.1.3.dev0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/psycopg.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 1rem;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     <a style="text-decoration: none; color: white;"
   href="https://github.com/sponsors/dvarrazzo/">
   <img height="24px" width="24px" src="/img/logo/psycopg-48.png"/>
    Sponsor psycopg3 on GitHub
</a>
 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">psycopg 3.1.3.dev0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/psycopg.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/psycopg.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">psycopg 3.1.3.dev0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Getting started with Psycopg 3</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Basic module usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="params.html">Passing parameters to SQL queries</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Adapting basic Python types</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgtypes.html">Adapting other PostgreSQL types</a></li>
<li class="toctree-l2"><a class="reference internal" href="transactions.html">Transactions management</a></li>
<li class="toctree-l2"><a class="reference internal" href="copy.html">Using COPY TO and COPY FROM</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_pg2.html">Differences from <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced/index.html">More advanced topics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/async.html">Asynchronous operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/typing.html">Static Typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/rows.html">Row factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/pool.html">Connection pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/cursors.html">Cursor types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/adapt.html">Data adaptation configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/prepare.html">Prepared statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/pipeline.html">Pipeline mode support</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">Psycopg 3 API</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/module.html">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/connections.html">Connection classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/cursors.html">Cursor classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/copy.html">COPY-related objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/objects.html">Other top-level objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sql.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql</span></code> – SQL string composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/rows.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code> – row factory implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/errors.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">errors</span></code> – Package exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pool.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg_pool</span></code> – Connection pool implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/conninfo.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conninfo</span></code> – manipulate connection strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/adapt.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adapt</span></code> – Types adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/types.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">types</span></code> – Types information and adapters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/abc.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc</span></code> – Psycopg abstract classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pq.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pq</span></code> – libpq wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/crdb.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">crdb</span></code> – CockroachDB support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/dns.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_dns</span></code> – DNS resolution utilities</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news.html"><code class="docutils literal notranslate"><span class="pre">psycopg</span></code> release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news_pool.html"><code class="docutils literal notranslate"><span class="pre">psycopg_pool</span></code> release notes</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="adapting-basic-python-types">
<span id="types-adaptation"></span><span id="index-0"></span><h1>Adapting basic Python types<a class="headerlink" href="#adapting-basic-python-types" title="Permalink to this heading">#</a></h1>
<p>Many standard Python types are adapted into SQL and returned as Python
objects when a query is executed.</p>
<p>Converting the following data types between Python and PostgreSQL works
out-of-the-box and doesn’t require any configuration. In case you need to
customise the conversion you should take a look at <a class="reference internal" href="../advanced/adapt.html#adaptation"><span class="std std-ref">Data adaptation configuration</span></a>.</p>
<section id="booleans-adaptation">
<span id="adapt-bool"></span><span id="index-1"></span><h2>Booleans adaptation<a class="headerlink" href="#booleans-adaptation" title="Permalink to this heading">#</a></h2>
<p>Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a> values <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code> are converted to the equivalent
<a class="reference external" href="https://www.postgresql.org/docs/current/datatype-boolean.html">PostgreSQL boolean type</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="go"># equivalent to &quot;SELECT true, false&quot;</span>
</pre></div>
</div>
</section>
<section id="numbers-adaptation">
<span id="adapt-numbers"></span><span id="index-2"></span><h2>Numbers adaptation<a class="headerlink" href="#numbers-adaptation" title="Permalink to this heading">#</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.postgresql.org/docs/current/static/datatype-numeric.html">PostgreSQL numeric types</a></p></li>
</ul>
</div>
<ul class="simple">
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a> values can be converted to PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">smallint</span></code>,
<code class="sql docutils literal notranslate"><span class="pre">integer</span></code>, <code class="sql docutils literal notranslate"><span class="pre">bigint</span></code>, or <code class="sql docutils literal notranslate"><span class="pre">numeric</span></code>, according to their numeric
value. Psycopg will choose the smallest data type available, because
PostgreSQL can automatically cast a type up (e.g. passing a <code class="xref py py-obj docutils literal notranslate"><span class="pre">smallint</span></code> where
PostgreSQL expect an <code class="xref py py-obj docutils literal notranslate"><span class="pre">integer</span></code> is gladly accepted) but will not cast down
automatically (e.g. if a function has an <code class="sql docutils literal notranslate"><span class="pre">integer</span></code> argument, passing it
a <code class="sql docutils literal notranslate"><span class="pre">bigint</span></code> value will fail, even if the value is 1).</p></li>
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> values are converted to PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">float8</span></code>.</p></li>
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/decimal.html#decimal.Decimal" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Decimal</span></code></a> values are converted to PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">numeric</span></code>.</p></li>
</ul>
<p>On the way back, smaller types (<code class="sql docutils literal notranslate"><span class="pre">int2</span></code>, <code class="sql docutils literal notranslate"><span class="pre">int4</span></code>, <code class="sql docutils literal notranslate"><span class="pre">float4</span></code>) are
promoted to the larger Python counterpart.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes you may prefer to receive <code class="sql docutils literal notranslate"><span class="pre">numeric</span></code> data as <code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>
instead, for performance reason or ease of manipulation: you can configure
an adapter to <a class="reference internal" href="../advanced/adapt.html#adapt-example-float"><span class="std std-ref">cast PostgreSQL numeric to Python float</span></a>. This of course may imply a loss of precision.</p>
</div>
</section>
<section id="strings-adaptation">
<span id="adapt-string"></span><span id="index-3"></span><h2>Strings adaptation<a class="headerlink" href="#strings-adaptation" title="Permalink to this heading">#</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.postgresql.org/docs/current/datatype-character.html">PostgreSQL character types</a></p></li>
</ul>
</div>
<p>Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> are converted to PostgreSQL string syntax, and PostgreSQL types
such as <code class="sql docutils literal notranslate"><span class="pre">text</span></code> and <code class="sql docutils literal notranslate"><span class="pre">varchar</span></code> are converted back to Python <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;INSERT INTO menu (id, entry) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Crème Brûlée at 4.99€&quot;</span><span class="p">))</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT entry FROM menu WHERE id = 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="s1">&#39;Crème Brûlée at 4.99€&#39;</span>
</pre></div>
</div>
<p>PostgreSQL databases <a class="reference external" href="https://www.postgresql.org/docs/current/sql-createdatabase.html">have an encoding</a>, and <a class="reference external" href="https://www.postgresql.org/docs/current/multibyte.html">the session has an encoding</a>
too, exposed in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.info.</span></code><a class="reference internal" href="../api/objects.html#psycopg.ConnectionInfo.encoding" title="psycopg.ConnectionInfo.encoding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">encoding</span></code></a>
attribute. If your database and connection are in UTF-8 encoding you will
likely have no problem, otherwise you will have to make sure that your
application only deals with the non-ASCII chars that the database can handle;
failing to do so may result in encoding/decoding errors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The encoding is set at connection time according to the db configuration</span>
<span class="n">conn</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">encoding</span>
<span class="s1">&#39;utf-8&#39;</span>

<span class="c1"># The Latin-9 encoding can manage some European accented letters</span>
<span class="c1"># and the Euro symbol</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET client_encoding TO LATIN9&quot;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT entry FROM menu WHERE id = 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="s1">&#39;Crème Brûlée at 4.99€&#39;</span>

<span class="c1"># The Latin-1 encoding doesn&#39;t have a representation for the Euro symbol</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET client_encoding TO LATIN1&quot;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT entry FROM menu WHERE id = 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Traceback (most recent call last)</span>
<span class="c1"># ...</span>
<span class="c1"># UntranslatableCharacter: character with byte sequence 0xe2 0x82 0xac</span>
<span class="c1"># in encoding &quot;UTF8&quot; has no equivalent in encoding &quot;LATIN1&quot;</span>
</pre></div>
</div>
<p>In rare cases you may have strings with unexpected encodings in the database.
Using the <code class="docutils literal notranslate"><span class="pre">SQL_ASCII</span></code> client encoding  will disable decoding of the data
coming from the database, which will be returned as <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET client_encoding TO SQL_ASCII&quot;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT entry FROM menu WHERE id = 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="sa">b</span><span class="s1">&#39;Cr</span><span class="se">\xc3\xa8</span><span class="s1">me Br</span><span class="se">\xc3\xbb</span><span class="s1">l</span><span class="se">\xc3\xa9</span><span class="s1">e at 4.99</span><span class="se">\xe2\x82\xac</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>Alternatively you can cast the unknown encoding data to <code class="sql docutils literal notranslate"><span class="pre">bytea</span></code> to
retrieve it as bytes, leaving other strings unaltered: see <a class="reference internal" href="#adapt-binary"><span class="std std-ref">Binary adaptation</span></a></p>
<p>Note that PostgreSQL text cannot contain the <code class="docutils literal notranslate"><span class="pre">0x00</span></code> byte. If you need to
store Python strings that may contain binary zeros you should use a
<code class="sql docutils literal notranslate"><span class="pre">bytea</span></code> field.</p>
</section>
<section id="binary-adaptation">
<span id="adapt-binary"></span><span id="index-4"></span><h2>Binary adaptation<a class="headerlink" href="#binary-adaptation" title="Permalink to this heading">#</a></h2>
<p>Python types representing binary objects (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytearray" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytearray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">memoryview</span></code></a>)
are converted by default to <code class="sql docutils literal notranslate"><span class="pre">bytea</span></code> fields. By default data received is
returned as <code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
<p>If you are storing large binary data in bytea fields (such as binary documents
or images) you should probably use the binary format to pass and return
values, otherwise binary data will undergo <a class="reference external" href="https://www.postgresql.org/docs/current/datatype-binary.html">ASCII escaping</a>, taking some CPU
time and more bandwidth. See <a class="reference internal" href="params.html#binary-data"><span class="std std-ref">Binary parameters and results</span></a> for details.</p>
</section>
<section id="date-time-types-adaptation">
<span id="adapt-date"></span><h2>Date/time types adaptation<a class="headerlink" href="#date-time-types-adaptation" title="Permalink to this heading">#</a></h2>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.postgresql.org/docs/current/datatype-datetime.html">PostgreSQL date/time types</a></p></li>
</ul>
</div>
<ul class="simple">
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.date" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">date</span></code></a> objects are converted to PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">date</span></code>.</p></li>
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime</span></code></a> objects are converted to PostgreSQL
<code class="sql docutils literal notranslate"><span class="pre">timestamp</span></code> (if they don’t have a <code class="xref py py-obj docutils literal notranslate"><span class="pre">tzinfo</span></code> set) or <code class="sql docutils literal notranslate"><span class="pre">timestamptz</span></code>
(if they do).</p></li>
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.time" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time</span></code></a> objects are converted to PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">time</span></code>
(if they don’t have a <code class="xref py py-obj docutils literal notranslate"><span class="pre">tzinfo</span></code> set) or <code class="sql docutils literal notranslate"><span class="pre">timetz</span></code> (if they do).</p></li>
<li><p>Python <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">timedelta</span></code></a> objects are converted to PostgreSQL
<code class="sql docutils literal notranslate"><span class="pre">interval</span></code>.</p></li>
</ul>
<p>PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">timestamptz</span></code> values are returned with a timezone set to the
<a class="reference external" href="https://www.postgresql.org/docs/current/datatype-datetime.html#DATATYPE-TIMEZONES">connection TimeZone setting</a>, which is available as a Python
<a class="reference external" href="https://docs.python.org/3/library/zoneinfo.html#zoneinfo.ZoneInfo" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ZoneInfo</span></code></a> object in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.info</span></code>.<a class="reference internal" href="../api/objects.html#psycopg.ConnectionInfo.timezone" title="psycopg.ConnectionInfo.timezone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">timezone</span></code></a>
attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">timezone</span>
<span class="go">zoneinfo.ZoneInfo(key=&#39;Europe/London&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select &#39;2048-07-08 12:00&#39;::timestamptz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">datetime.datetime(2048, 7, 8, 12, 0, tzinfo=zoneinfo.ZoneInfo(key=&#39;Europe/London&#39;))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">timestamptz</span></code> doesn’t store “a timestamp with a timezone
attached”: it stores a timestamp always in UTC, which is converted, on
output, to the connection TimeZone setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET TIMEZONE to &#39;Europe/Rome&#39;&quot;</span><span class="p">)</span>  <span class="c1"># UTC+2 in summer</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT &#39;2042-07-01 12:00Z&#39;::timestamptz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># UTC input</span>
<span class="go">datetime.datetime(2042, 7, 1, 14, 0, tzinfo=zoneinfo.ZoneInfo(key=&#39;Europe/Rome&#39;))</span>
</pre></div>
</div>
<p>Check out the <a class="reference external" href="https://www.postgresql.org/docs/current/runtime-config-client.html#GUC-TIMEZONE">PostgreSQL documentation about timezones</a> for all the
details.</p>
</div>
</section>
<section id="json-adaptation">
<span id="adapt-json"></span><h2>JSON adaptation<a class="headerlink" href="#json-adaptation" title="Permalink to this heading">#</a></h2>
<p>Psycopg can map between Python objects and PostgreSQL <a class="reference external" href="https://www.postgresql.org/docs/current/datatype-json.html">json/jsonb
types</a>, allowing to customise the load and dump function used.</p>
<p>Because several Python objects could be considered JSON (dicts, lists,
scalars, even date/time if using a dumps function customised to use them),
Psycopg requires you to wrap the object to dump as JSON into a wrapper:
either <a class="reference internal" href="../api/types.html#psycopg.types.json.Json" title="psycopg.types.json.Json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg.types.json.Json</span></code></a> or <a class="reference internal" href="../api/types.html#psycopg.types.json.Jsonb" title="psycopg.types.json.Jsonb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Jsonb</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psycopg.types.json</span> <span class="kn">import</span> <span class="n">Jsonb</span>

<span class="n">thing</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">]}</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO mytable VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Jsonb</span><span class="p">(</span><span class="n">thing</span><span class="p">)])</span>
</pre></div>
</div>
<p>By default Psycopg uses the standard library <a class="reference external" href="https://docs.python.org/3/library/json.html#json.dumps" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">json.dumps</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/json.html#json.loads" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">json.loads</span></code></a>
functions to serialize and de-serialize Python objects to JSON. If you want to
customise how serialization happens, for instance changing serialization
parameters or using a different JSON library, you can specify your own
functions using the <a class="reference internal" href="../api/types.html#psycopg.types.json.set_json_dumps" title="psycopg.types.json.set_json_dumps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg.types.json.set_json_dumps()</span></code></a> and
<a class="reference internal" href="../api/types.html#psycopg.types.json.set_json_loads" title="psycopg.types.json.set_json_loads"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_json_loads()</span></code></a> functions, to apply either globally or
to a specific context (connection or cursor).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">psycopg.types.json</span> <span class="kn">import</span> <span class="n">Jsonb</span><span class="p">,</span> <span class="n">set_json_dumps</span><span class="p">,</span> <span class="n">set_json_loads</span>
<span class="kn">import</span> <span class="nn">ujson</span>

<span class="c1"># Use a faster dump function</span>
<span class="n">set_json_dumps</span><span class="p">(</span><span class="n">ujson</span><span class="o">.</span><span class="n">dumps</span><span class="p">)</span>

<span class="c1"># Return floating point values as Decimal, just in one connection</span>
<span class="n">set_json_loads</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">,</span> <span class="n">parse_float</span><span class="o">=</span><span class="n">Decimal</span><span class="p">),</span> <span class="n">conn</span><span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Jsonb</span><span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mf">123.45</span><span class="p">})])</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># {&#39;value&#39;: Decimal(&#39;123.45&#39;)}</span>
</pre></div>
</div>
<p>If you need an even more specific dump customisation only for certain objects
(including different configurations in the same query) you can specify a
<code class="docutils literal notranslate"><span class="pre">dumps</span></code> parameter in the
<a class="reference internal" href="../api/types.html#psycopg.types.json.Json" title="psycopg.types.json.Json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Json</span></code></a>/<a class="reference internal" href="../api/types.html#psycopg.types.json.Jsonb" title="psycopg.types.json.Jsonb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Jsonb</span></code></a> wrapper, which will
take precedence over what is specified by <code class="xref py py-obj docutils literal notranslate"><span class="pre">set_json_dumps()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">uuid4</span>

<span class="k">class</span> <span class="nc">UUIDEncoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A JSON encoder which can dump UUID.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">UUID</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

<span class="n">uuid_dumps</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">UUIDEncoder</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">uuid4</span><span class="p">()}</span>
<span class="n">cnn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO objs VALUES </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Json</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">dumps</span><span class="o">=</span><span class="n">uuid_dumps</span><span class="p">)])</span>
<span class="c1"># will insert: {&#39;uuid&#39;: &#39;0a40799d-3980-4c65-8315-2956b18ab0e1&#39;}</span>
</pre></div>
</div>
</section>
<section id="lists-adaptation">
<span id="adapt-list"></span><h2>Lists adaptation<a class="headerlink" href="#lists-adaptation" title="Permalink to this heading">#</a></h2>
<p>Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> objects are adapted to <a class="reference external" href="https://www.postgresql.org/docs/current/arrays.html">PostgreSQL arrays</a> and back. Only
lists containing objects of the same type can be dumped to PostgreSQL (but the
list may contain <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> elements).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a list of values which you want to use with the <code class="sql docutils literal notranslate"><span class="pre">IN</span></code>
operator… don’t. It won’t work (neither with a list nor with a tuple):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM mytable WHERE id IN </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]])</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">psycopg.errors.SyntaxError</span>: <span class="n">syntax error at or near &quot;$1&quot;</span>
<span class="go">LINE 1: SELECT * FROM mytable WHERE id IN $1</span>
<span class="go">                                          ^</span>
</pre></div>
</div>
<p>What you want to do instead is to use the <a class="reference external" href="https://www.postgresql.org/docs/current/functions-comparisons.html#id-1.5.8.30.16">‘= ANY()’ expression</a> and pass
the values as a list (not a tuple).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM mytable WHERE id = ANY(</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]])</span>
</pre></div>
</div>
<p>This has also the advantage of working with an empty list, whereas <code class="docutils literal notranslate"><span class="pre">IN</span>
<span class="pre">()</span></code> is not valid SQL.</p>
</div>
</section>
<section id="uuid-adaptation">
<span id="adapt-uuid"></span><h2>UUID adaptation<a class="headerlink" href="#uuid-adaptation" title="Permalink to this heading">#</a></h2>
<p>Python <a class="reference external" href="https://docs.python.org/3/library/uuid.html#uuid.UUID" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uuid.UUID</span></code></a> objects are adapted to PostgreSQL <a class="reference external" href="https://www.postgresql.org/docs/current/datatype-uuid.html">UUID type</a> and back:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select gen_random_uuid()&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">UUID(&#39;97f0dd62-3bd2-459e-89b8-a5e36ea3c16c&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">uuid4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select gen_random_uuid() = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">uuid4</span><span class="p">()])</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">False  # long shot</span>
</pre></div>
</div>
</section>
<section id="network-data-types-adaptation">
<span id="adapt-network"></span><h2>Network data types adaptation<a class="headerlink" href="#network-data-types-adaptation" title="Permalink to this heading">#</a></h2>
<p>Objects from the <a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#module-ipaddress" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipaddress</span></code></a> module are converted to PostgreSQL <a class="reference external" href="https://www.postgresql.org/docs/current/datatype-net-types.html#DATATYPE-CIDR">network
address types</a>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Address" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv4Address</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Interface" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv4Interface</span></code></a> objects are converted
to the PostgreSQL <code class="sql docutils literal notranslate"><span class="pre">inet</span></code> type. On the way back, <code class="sql docutils literal notranslate"><span class="pre">inet</span></code> values
indicating a single address are converted to <code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv4Address</span></code>, otherwise they
are converted to <code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv4Interface</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Network" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv4Network</span></code></a> objects are converted to the <code class="sql docutils literal notranslate"><span class="pre">cidr</span></code> type and
back.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv6Address" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv6Address</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv6Interface" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv6Interface</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv6Network" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPv6Network</span></code></a> objects follow the same rules, with IPv6
<code class="sql docutils literal notranslate"><span class="pre">inet</span></code> and <code class="sql docutils literal notranslate"><span class="pre">cidr</span></code> values.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select &#39;192.168.0.1&#39;::inet, &#39;192.168.0.1/24&#39;::inet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">(IPv4Address(&#39;192.168.0.1&#39;), IPv4Interface(&#39;192.168.0.1/24&#39;))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select &#39;::ffff:1.2.3.0/120&#39;::cidr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">IPv6Network(&#39;::ffff:102:300/120&#39;)</span>
</pre></div>
</div>
</section>
<section id="enum-adaptation">
<span id="adapt-enum"></span><h2>Enum adaptation<a class="headerlink" href="#enum-adaptation" title="Permalink to this heading">#</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 3.1.</span></p>
</div>
<p>Psycopg can adapt Python <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Enum</span></code></a> subclasses into PostgreSQL enum types
(created with the <a class="reference external" href="https://www.postgresql.org/docs/current/static/datatype-enum.html"><code class="sql docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TYPE</span> <span class="pre">...</span> <span class="pre">AS</span> <span class="pre">ENUM</span> <span class="pre">(...)</span></code></a> command).</p>
<p>In order to set up a bidirectional enum mapping, you should get information
about the PostgreSQL enum using the <a class="reference internal" href="#psycopg.types.enum.EnumInfo" title="psycopg.types.enum.EnumInfo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EnumInfo</span></code></a> class and
register it using <a class="reference internal" href="#psycopg.types.enum.register_enum" title="psycopg.types.enum.register_enum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_enum()</span></code></a>. The behaviour of unregistered
and registered enums is different.</p>
<ul>
<li><p>If the enum is not registered with <code class="xref py py-obj docutils literal notranslate"><span class="pre">register_enum()</span></code>:</p>
<ul>
<li><p>Pure <code class="xref py py-obj docutils literal notranslate"><span class="pre">Enum</span></code> classes are dumped as normal strings, using their member
names as value. The unknown oid is used, so PostgreSQL should be able to
use this string in most contexts (such as an enum or a text field).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 3.1: </span>In previous version dumping pure enums is not supported and raise a
“cannot adapt” error.</p>
</div>
</li>
<li><p>Mix-in enums are dumped according to their mix-in type (because a <code class="xref py py-obj docutils literal notranslate"><span class="pre">class</span>
<span class="pre">MyIntEnum(int,</span> <span class="pre">Enum)</span></code> is more specifically an <code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code> than an <code class="xref py py-obj docutils literal notranslate"><span class="pre">Enum</span></code>, so
it’s dumped by default according to <code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code> rules).</p></li>
<li><p>PostgreSQL enums are loaded as Python strings. If you want to load arrays
of such enums you will have to find their OIDs using <a class="reference internal" href="../api/types.html#psycopg.types.TypeInfo.fetch" title="psycopg.types.TypeInfo.fetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">types.TypeInfo.fetch()</span></code></a>
and register them using <a class="reference internal" href="../api/types.html#psycopg.types.TypeInfo.register" title="psycopg.types.TypeInfo.register"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register()</span></code></a>.</p></li>
</ul>
</li>
<li><p>If the enum is registered (using <a class="reference internal" href="#psycopg.types.enum.EnumInfo" title="psycopg.types.enum.EnumInfo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EnumInfo</span></code></a><code class="xref py py-obj docutils literal notranslate"><span class="pre">.fetch()</span></code> and
<a class="reference internal" href="#psycopg.types.enum.register_enum" title="psycopg.types.enum.register_enum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_enum()</span></code></a>):</p>
<ul class="simple">
<li><p>Enums classes, both pure and mixed-in, are dumped by name.</p></li>
<li><p>The registered PostgreSQL enum is loaded back as the registered Python
enum members.</p></li>
</ul>
</li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="psycopg.types.enum.EnumInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">psycopg.types.enum.</span></span><span class="sig-name descname"><span class="pre">EnumInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_oid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg.types.enum.EnumInfo" title="Permalink to this definition">#</a></dt>
<dd><p>Manage information about an enum type.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">EnumInfo</span></code> is a subclass of <a class="reference internal" href="../api/types.html#psycopg.types.TypeInfo" title="psycopg.types.TypeInfo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TypeInfo</span></code></a>: refer to the
latter’s documentation for generic usage, especially the
<a class="reference internal" href="../api/types.html#psycopg.types.TypeInfo.fetch" title="psycopg.types.TypeInfo.fetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch()</span></code></a> method.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="psycopg.types.enum.EnumInfo.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#psycopg.types.enum.EnumInfo.labels" title="Permalink to this definition">#</a></dt>
<dd><p>After <a class="reference internal" href="../api/types.html#psycopg.types.TypeInfo.fetch" title="psycopg.types.TypeInfo.fetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch()</span></code></a>, it contains the labels defined
in the PostgreSQL enum type.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psycopg.types.enum.EnumInfo.enum">
<span class="sig-name descname"><span class="pre">enum</span></span><a class="headerlink" href="#psycopg.types.enum.EnumInfo.enum" title="Permalink to this definition">#</a></dt>
<dd><p>After <a class="reference internal" href="#psycopg.types.enum.register_enum" title="psycopg.types.enum.register_enum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_enum()</span></code></a> is called, it will contain the Python type
mapping to the registered enum.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psycopg.types.enum.register_enum">
<span class="sig-prename descclassname"><span class="pre">psycopg.types.enum.</span></span><span class="sig-name descname"><span class="pre">register_enum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg.types.enum.register_enum" title="Permalink to this definition">#</a></dt>
<dd><p>Register the adapters to load and dump a enum type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>info</strong> (<a class="reference internal" href="#psycopg.types.enum.EnumInfo" title="psycopg.types.enum.EnumInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnumInfo</span></code></a>) – The object with the information about the enum to register.</p></li>
<li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="../api/abc.html#psycopg.abc.AdaptContext" title="psycopg.abc.AdaptContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptContext</span></code></a>]) – The context where to register the adapters. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>,
register it globally.</p></li>
<li><p><strong>enum</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>)]]) – Python enum type matching to the PostgreSQL one. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>,
a new enum will be generated and exposed as <a class="reference internal" href="#psycopg.types.enum.EnumInfo.enum" title="psycopg.types.enum.EnumInfo.enum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EnumInfo.enum</span></code></a>.</p></li>
<li><p><strong>mapping</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>), <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>), <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – Override the mapping between <code class="xref py py-obj docutils literal notranslate"><span class="pre">enum</span></code> members and <code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code>
labels.</p></li>
</ul>
</dd>
</dl>
<p>After registering, fetching data of the registered enum will cast
PostgreSQL enum labels into corresponding Python enum members.</p>
<p>If no <code class="xref py py-obj docutils literal notranslate"><span class="pre">enum</span></code> is specified, a new <code class="xref py py-obj docutils literal notranslate"><span class="pre">Enum</span></code> is created based on
PostgreSQL enum labels.</p>
</dd></dl>

<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">psycopg.types.enum</span> <span class="kn">import</span> <span class="n">EnumInfo</span><span class="p">,</span> <span class="n">register_enum</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">UserRole</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ADMIN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">EDITOR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">GUEST</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE TYPE user_role AS ENUM (&#39;ADMIN&#39;, &#39;EDITOR&#39;, &#39;GUEST&#39;)&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">EnumInfo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s2">&quot;user_role&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">register_enum</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">UserRole</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">some_editor</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">EDITOR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_editor</span>
<span class="go">&lt;UserRole.EDITOR: 2&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT pg_typeof(</span><span class="si">%(editor)s</span><span class="s2">), </span><span class="si">%(editor)s</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;editor&quot;</span><span class="p">:</span> <span class="n">some_editor</span><span class="p">}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">(&#39;user_role&#39;, &lt;UserRole.EDITOR: 2&gt;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT ARRAY[</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">]&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">UserRole</span><span class="o">.</span><span class="n">ADMIN</span><span class="p">,</span> <span class="n">UserRole</span><span class="o">.</span><span class="n">GUEST</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">[&lt;UserRole.ADMIN: 1&gt;, &lt;UserRole.GUEST: 3&gt;]</span>
</pre></div>
</div>
<p>If the Python and the PostgreSQL enum don’t match 1:1 (for instance if members
have a different name, or if more than one Python enum should map to the same
PostgreSQL enum, or vice versa), you can specify the exceptions using the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">mapping</span></code> parameter.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mapping</span></code> should be a dictionary with Python enum members as keys and the
matching PostgreSQL enum labels as values, or a list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">(member,</span> <span class="pre">label)</span></code>
pairs with the same meaning (useful when some members are repeated). Order
matters: if an element on either side is specified more than once, the last
pair in the sequence will take precedence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Legacy roles, defined in medieval times.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="o">...</span>     <span class="s2">&quot;CREATE TYPE abbey_role AS ENUM (&#39;ABBOT&#39;, &#39;SCRIBE&#39;, &#39;MONK&#39;, &#39;GUEST&#39;)&quot;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">info</span> <span class="o">=</span> <span class="n">EnumInfo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s2">&quot;abbey_role&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">register_enum</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">UserRole</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">[</span>
<span class="o">...</span>     <span class="p">(</span><span class="n">UserRole</span><span class="o">.</span><span class="n">ADMIN</span><span class="p">,</span> <span class="s2">&quot;ABBOT&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="n">UserRole</span><span class="o">.</span><span class="n">EDITOR</span><span class="p">,</span> <span class="s2">&quot;SCRIBE&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="n">UserRole</span><span class="o">.</span><span class="n">EDITOR</span><span class="p">,</span> <span class="s2">&quot;MONK&quot;</span><span class="p">)])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT &#39;{ABBOT,SCRIBE,MONK,GUEST}&#39;::abbey_role[]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">UserRole</span><span class="o">.</span><span class="n">ADMIN</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">UserRole</span><span class="o">.</span><span class="n">EDITOR</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">UserRole</span><span class="o">.</span><span class="n">EDITOR</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">UserRole</span><span class="o">.</span><span class="n">GUEST</span><span class="p">:</span> <span class="mi">3</span><span class="o">&gt;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT </span><span class="si">%s</span><span class="s2">::text[]&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">UserRole</span><span class="p">)])</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;ABBOT&#39;</span><span class="p">,</span> <span class="s1">&#39;MONK&#39;</span><span class="p">,</span> <span class="s1">&#39;GUEST&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>A particularly useful case is when the PostgreSQL labels match the <em>values</em> of
a <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>-based Enum. In this case it is possible to use something like <code class="docutils literal notranslate"><span class="pre">{m:</span>
<span class="pre">m.value</span> <span class="pre">for</span> <span class="pre">m</span> <span class="pre">in</span> <span class="pre">enum}</span></code> as mapping:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LowercaseRole</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ADMIN</span> <span class="o">=</span> <span class="s2">&quot;admin&quot;</span>
<span class="gp">... </span>    <span class="n">EDITOR</span> <span class="o">=</span> <span class="s2">&quot;editor&quot;</span>
<span class="gp">... </span>    <span class="n">GUEST</span> <span class="o">=</span> <span class="s2">&quot;guest&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;CREATE TYPE lowercase_role AS ENUM (&#39;admin&#39;, &#39;editor&#39;, &#39;guest&#39;)&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">EnumInfo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s2">&quot;lowercase_role&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">register_enum</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">info</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">LowercaseRole</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">LowercaseRole</span><span class="p">})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT &#39;editor&#39;::lowercase_role&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;LowercaseRole.EDITOR: &#39;editor&#39;&gt;</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pgtypes.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Adapting other PostgreSQL types</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="params.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Passing parameters to SQL queries</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020, Daniele Varrazzo and The Psycopg Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Adapting basic Python types</a><ul>
<li><a class="reference internal" href="#booleans-adaptation">Booleans adaptation</a></li>
<li><a class="reference internal" href="#numbers-adaptation">Numbers adaptation</a></li>
<li><a class="reference internal" href="#strings-adaptation">Strings adaptation</a></li>
<li><a class="reference internal" href="#binary-adaptation">Binary adaptation</a></li>
<li><a class="reference internal" href="#date-time-types-adaptation">Date/time types adaptation</a></li>
<li><a class="reference internal" href="#json-adaptation">JSON adaptation</a></li>
<li><a class="reference internal" href="#lists-adaptation">Lists adaptation</a></li>
<li><a class="reference internal" href="#uuid-adaptation">UUID adaptation</a></li>
<li><a class="reference internal" href="#network-data-types-adaptation">Network data types adaptation</a></li>
<li><a class="reference internal" href="#enum-adaptation">Enum adaptation</a><ul>
<li><a class="reference internal" href="#psycopg.types.enum.EnumInfo"><code class="docutils literal notranslate"><span class="pre">EnumInfo</span></code></a><ul>
<li><a class="reference internal" href="#psycopg.types.enum.EnumInfo.labels"><code class="docutils literal notranslate"><span class="pre">EnumInfo.labels</span></code></a></li>
<li><a class="reference internal" href="#psycopg.types.enum.EnumInfo.enum"><code class="docutils literal notranslate"><span class="pre">EnumInfo.enum</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#psycopg.types.enum.register_enum"><code class="docutils literal notranslate"><span class="pre">register_enum()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>psycopg3.sql – SQL string composition &#8212; psycopg3 UNRELEASED documentation</title>
    <style type="text/css" media="screen">
div.sponsor {
  background-color: #ffc;
  border: 2px solid #888;
  border-radius: 8px;
  padding: 1em;
  padding-bottom: 0.25em;
  margin-top: 1em;
}
div.sponsor p {
  margin: 0.5rem 0;
}
    </style>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/better.css" type="text/css" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19287248-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19287248-2');
    </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="psycopg3.errors – package exceptions" href="errors.html" />
    <link rel="prev" title="Cursor classes" href="cursor.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <link rel="stylesheet" href="_static/psycopg.css" type="text/css" />
  </head><body>
    <header id="pageheader"><h1><a href="index.html ">
        psycopg3 UNRELEASED documentation
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="cursor.html" title="Previous document">Cursor classes</a>
        </li>
        <li>
          <a href="errors.html" title="Next document"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.errors</span></code> – package exceptions</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">psycopg3 UNRELEASED documentation</a></li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
    <div class="sponsor">
      <p>
      The <a href="https://psycopg.org/psycopg3" target="_blank"
        >psycopg3 project</a>
      is currently
      <a href="https://github.com/psycopg/psycopg3" target="_blank"
        >under active development</a>.
      </p>

      <p>
      Sponsoring this project will help achieve swift completion and
      ensure the maintenance of psycopg2, psycopg3 and other related
      projects.
      </p>

      <p>
      If you use Python and PostgreSQL, and you would like to support the
      creation of the most advanced adapter between the two systems,
      <a href="https://github.com/sponsors/dvarrazzo/" target="_blank"
        >please consider becoming a sponsor</a>. Thank you!
      </p>

      <iframe src="https://github.com/sponsors/dvarrazzo/button"
              title="Sponsor the project" style="border: 0"
              width="116" height="35">
      </iframe>
    </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="psycopg3-sql-sql-string-composition">
<h1><a class="reference internal" href="#module-psycopg3.sql" title="psycopg3.sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.sql</span></code></a> – SQL string composition<a class="headerlink" href="#psycopg3-sql-sql-string-composition" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-psycopg3.sql"><span id="index-0"></span></span><p>The module contains objects and functions useful to generate SQL dynamically,
in a convenient and safe way. SQL identifiers (e.g. names of tables and
fields) cannot be passed to the <a class="reference internal" href="cursor.html#psycopg3.Cursor.execute" title="psycopg3.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a> method like query
arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will not work</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;my_table&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into </span><span class="si">%s</span><span class="s2"> values (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">table_name</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<p>The SQL query should be composed before the arguments are merged, for
instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This works, but it is not optimal</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;my_table&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;insert into </span><span class="si">%s</span><span class="s2"> values (</span><span class="si">%%</span><span class="s2">s, </span><span class="si">%%</span><span class="s2">s)&quot;</span> <span class="o">%</span> <span class="n">table_name</span><span class="p">,</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<p>This sort of works, but it is an accident waiting to happen: the table name
may be an invalid SQL literal and need quoting; even more serious is the
security problem in case the table name comes from an untrusted source. The
name should be escaped using <code class="xref py py-obj docutils literal notranslate"><span class="pre">escape_identifier()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psycopg3.pq</span> <span class="kn">import</span> <span class="n">Escaping</span>

<span class="c1"># This works, but it is not optimal</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;my_table&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;insert into </span><span class="si">%s</span><span class="s2"> values (</span><span class="si">%%</span><span class="s2">s, </span><span class="si">%%</span><span class="s2">s)&quot;</span> <span class="o">%</span> <span class="n">Escaping</span><span class="o">.</span><span class="n">escape_identifier</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<p>This is now safe, but it somewhat ad-hoc. In case, for some reason, it is
necessary to include a value in the query string (as opposite as in a value)
the merging rule is still different. It is also still relatively dangerous: if
<code class="xref py py-obj docutils literal notranslate"><span class="pre">escape_identifier()</span></code> is forgotten somewhere, the program will usually work,
but will eventually crash in the presence of a table or field name with
containing characters to escape, or will present a potentially exploitable
weakness.</p>
<p>The objects exposed by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.sql</span></code> module allow generating SQL
statements on the fly, separating clearly the variable parts of the statement
from the query parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psycopg3</span> <span class="kn">import</span> <span class="n">sql</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;insert into </span><span class="si">{}</span><span class="s2"> values (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">)),</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="module-usage">
<h2>Module usage<a class="headerlink" href="#module-usage" title="Permalink to this headline">¶</a></h2>
<p>Usually you should express the template of your query as an <a class="reference internal" href="#psycopg3.sql.SQL" title="psycopg3.sql.SQL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code></a> instance
with <code class="docutils literal notranslate"><span class="pre">{}</span></code>-style placeholders and use <a class="reference internal" href="#psycopg3.sql.SQL.format" title="psycopg3.sql.SQL.format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">format()</span></code></a> to merge the variable
parts into them, all of which must be <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> subclasses. You can still
have <code class="docutils literal notranslate"><span class="pre">%s</span></code>-style placeholders in your query and pass values to
<a class="reference internal" href="cursor.html#psycopg3.Cursor.execute" title="psycopg3.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a>: such value placeholders will be untouched by
<code class="xref py py-obj docutils literal notranslate"><span class="pre">format()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;select </span><span class="si">{field}</span><span class="s2"> from </span><span class="si">{table}</span><span class="s2"> where </span><span class="si">{pkey}</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">field</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;my_name&#39;</span><span class="p">),</span>
    <span class="n">table</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;some_table&#39;</span><span class="p">),</span>
    <span class="n">pkey</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>The resulting object is meant to be passed directly to cursor methods such as
<a class="reference internal" href="cursor.html#psycopg3.Cursor.execute" title="psycopg3.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor.executemany" title="psycopg3.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">executemany()</span></code></a>,
<a class="reference internal" href="cursor.html#psycopg3.Cursor.copy" title="psycopg3.Cursor.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy()</span></code></a>, but can also be used to compose a query as a Python
string, using the <a class="reference internal" href="#psycopg3.sql.Composable.as_string" title="psycopg3.sql.Composable.as_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_string()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,))</span>
<span class="n">full_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
</pre></div>
</div>
<p>If part of your query is a variable sequence of arguments, such as a
comma-separated list of field names, you can use the <a class="reference internal" href="#psycopg3.sql.SQL.join" title="psycopg3.sql.SQL.join"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL.join()</span></code></a> method to
pass them to the query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;select </span><span class="si">{fields}</span><span class="s2"> from </span><span class="si">{table}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;field1&#39;</span><span class="p">),</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;field2&#39;</span><span class="p">),</span>
        <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;field3&#39;</span><span class="p">),</span>
    <span class="p">]),</span>
    <span class="n">table</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;some_table&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="sql-objects">
<h2><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql</span></code> objects<a class="headerlink" href="#sql-objects" title="Permalink to this headline">¶</a></h2>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">sql</span></code> objects are in the following inheritance hierarchy:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a>: the base class exposing the common interface</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">|__</span></code> <a class="reference internal" href="#psycopg3.sql.SQL" title="psycopg3.sql.SQL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code></a>: a literal snippet of an SQL query</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">|__</span></code> <a class="reference internal" href="#psycopg3.sql.Identifier" title="psycopg3.sql.Identifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Identifier</span></code></a>: a PostgreSQL identifier or dot-separated sequence of identifiers</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">|__</span></code> <a class="reference internal" href="#psycopg3.sql.Literal" title="psycopg3.sql.Literal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Literal</span></code></a>: a value hardcoded into a query</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">|__</span></code> <a class="reference internal" href="#psycopg3.sql.Placeholder" title="psycopg3.sql.Placeholder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Placeholder</span></code></a>: a <code class="xref py py-obj docutils literal notranslate"><span class="pre">%s</span></code>-style placeholder whose value will be added later e.g. by <a class="reference internal" href="cursor.html#psycopg3.Cursor.execute" title="psycopg3.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">|__</span></code> <a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code></a>: a sequence of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> instances.</div>
</div>
<dl class="py class">
<dt id="psycopg3.sql.Composable">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">Composable</code><a class="headerlink" href="#psycopg3.sql.Composable" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for objects that can be used to compose an SQL string.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> objects can be passed directly to
<a class="reference internal" href="cursor.html#psycopg3.Cursor.execute" title="psycopg3.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor.executemany" title="psycopg3.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">executemany()</span></code></a>,
<a class="reference internal" href="cursor.html#psycopg3.Cursor.copy" title="psycopg3.Cursor.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy()</span></code></a> in place of the query string.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> objects can be joined using the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator: the result
will be a <a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code></a> instance containing the objects joined. The operator
<code class="docutils literal notranslate"><span class="pre">*</span></code> is also supported with an integer argument: the result is a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code> instance containing the left argument repeated as many times as
requested.</p>
<dl class="py method">
<dt id="psycopg3.sql.Composable.as_string">
<code class="sig-name descname">as_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">context</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><span class="p">, </span>BaseConnection<span class="p">, </span>BaseCursor<span class="p">, </span>Transformer<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a><a class="headerlink" href="#psycopg3.sql.Composable.as_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the string value of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>context</strong> (<a class="reference external" href="https://www.psycopg.org/docs/connection.html#connection" title="(in Psycopg v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span></code></a> or <a class="reference external" href="https://www.psycopg.org/docs/cursor.html#cursor" title="(in Psycopg v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cursor</span></code></a>) – the context to evaluate the string into.</p>
</dd>
</dl>
<p>The method is automatically invoked by <a class="reference internal" href="cursor.html#psycopg3.Cursor.execute" title="psycopg3.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a>,
<a class="reference internal" href="cursor.html#psycopg3.Cursor.executemany" title="psycopg3.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">executemany()</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor.copy" title="psycopg3.Cursor.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy()</span></code></a> if a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> is passed instead of the query string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="psycopg3.sql.SQL">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">SQL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.sql.SQL" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> representing a snippet of SQL statement.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code> exposes <a class="reference internal" href="#psycopg3.sql.SQL.join" title="psycopg3.sql.SQL.join"><code class="xref py py-obj docutils literal notranslate"><span class="pre">join()</span></code></a> and <a class="reference internal" href="#psycopg3.sql.SQL.format" title="psycopg3.sql.SQL.format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">format()</span></code></a> methods useful to create a template
where to merge variable parts of a query (for instance field or table
names).</p>
<p>The <em>string</em> doesn’t undergo any form of escaping, so it is not suitable to
represent variable identifiers or values: you should only use it to pass
constant strings representing templates or snippets of SQL statements; use
other objects such as <a class="reference internal" href="#psycopg3.sql.Identifier" title="psycopg3.sql.Identifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Identifier</span></code></a> or <a class="reference internal" href="#psycopg3.sql.Literal" title="psycopg3.sql.Literal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Literal</span></code></a> to represent variable
parts.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;select </span><span class="si">{0}</span><span class="s2"> from </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">),</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">)]),</span>
<span class="gp">... </span>   <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">select &quot;foo&quot;, &quot;bar&quot; from &quot;table&quot;</span>
</pre></div>
</div>
<dl class="py method">
<dt id="psycopg3.sql.SQL.format">
<code class="sig-name descname">format</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed">psycopg3.sql.Composed</a><a class="headerlink" href="#psycopg3.sql.SQL.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> objects into a template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – parameters to replace to numbered (<code class="docutils literal notranslate"><span class="pre">{0}</span></code>, <code class="docutils literal notranslate"><span class="pre">{1}</span></code>) or
auto-numbered (<code class="docutils literal notranslate"><span class="pre">{}</span></code>) placeholders</p></li>
<li><p><strong>kwargs</strong> – parameters to replace to named (<code class="docutils literal notranslate"><span class="pre">{name}</span></code>) placeholders</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the union of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code> string with placeholders replaced</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code></a></p>
</dd>
</dl>
<p>The method is similar to the Python <code class="xref py py-obj docutils literal notranslate"><span class="pre">str.format()</span></code> method: the string
template supports auto-numbered (<code class="docutils literal notranslate"><span class="pre">{}</span></code>), numbered (<code class="docutils literal notranslate"><span class="pre">{0}</span></code>,
<code class="docutils literal notranslate"><span class="pre">{1}</span></code>…), and named placeholders (<code class="docutils literal notranslate"><span class="pre">{name}</span></code>), with positional
arguments replacing the numbered placeholders and keywords replacing
the named ones. However placeholder modifiers (<code class="docutils literal notranslate"><span class="pre">{0!r}</span></code>, <code class="docutils literal notranslate"><span class="pre">{0:&lt;10}</span></code>)
are not supported.</p>
<p>If a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> objects is passed to the template it will be merged
according to its <code class="xref py py-obj docutils literal notranslate"><span class="pre">as_string()</span></code> method. If any other Python object is
passed, it will be wrapped in a <a class="reference internal" href="#psycopg3.sql.Literal" title="psycopg3.sql.Literal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Literal</span></code></a> object and so escaped
according to SQL rules.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;select * from </span><span class="si">{}</span><span class="s2"> where </span><span class="si">{}</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;people&#39;</span><span class="p">),</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">select * from &quot;people&quot; where &quot;id&quot; = %s</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;select * from </span><span class="si">{tbl}</span><span class="s2"> where name = </span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="o">=</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;people&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;O&#39;Rourke&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">select * from &quot;people&quot; where name = &#39;O&#39;&#39;Rourke&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="psycopg3.sql.SQL.join">
<code class="sig-name descname">join</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable">psycopg3.sql.Composable</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed">psycopg3.sql.Composed</a><a class="headerlink" href="#psycopg3.sql.SQL.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Join a sequence of <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seq</strong> (iterable of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code>) – the elements to join.</p>
</dd>
</dl>
<p>Use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code> object’s <em>string</em> to separate the elements in <em>seq</em>.
Note that <a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code></a> objects are iterable too, so they can be used as
argument for this method.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snip</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snip</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="psycopg3.sql.Identifier">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">Identifier</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">strings</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.sql.Identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> representing an SQL identifier or a dot-separated sequence.</p>
<p>Identifiers usually represent names of database objects, such as tables or
fields. PostgreSQL identifiers follow <a class="reference external" href="https://www.postgresql.org/docs/current/static/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS">different rules</a> than SQL string
literals for escaping (e.g. they use double quotes instead of single).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s2">&quot;ba&#39;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;ba&quot;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">])</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">&quot;foo&quot;, &quot;ba&#39;r&quot;, &quot;ba&quot;&quot;z&quot;</span>
</pre></div>
</div>
<p>Multiple strings can be passed to the object to represent a qualified name,
i.e. a dot-separated sequence of identifiers.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;select </span><span class="si">{}</span><span class="s2"> from </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s2">&quot;schema&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">select &quot;table&quot;.&quot;field&quot; from &quot;schema&quot;.&quot;table&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="psycopg3.sql.Literal">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">Literal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.sql.Literal" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> representing an SQL value to include in a query.</p>
<p>Usually you will want to include placeholders in the query and pass values
as <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code> arguments. If however you really really need to
include a literal value in the query you can use this object.</p>
<p>The string returned by <code class="xref py py-obj docutils literal notranslate"><span class="pre">as_string()</span></code> follows the normal <a class="reference external" href="https://www.psycopg.org/docs/usage.html#python-types-adaptation" title="(in Psycopg v2.8)"><span class="xref std std-ref">adaptation
rules</span></a> for Python objects.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;ba&#39;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">])</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">&#39;foo&#39;, &#39;ba&#39;&#39;r&#39;, 42</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="psycopg3.sql.Placeholder">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">Placeholder</code><span class="sig-paren">(</span><em class="sig-param">name: str = ''</em>, <em class="sig-param">format: psycopg3.pq.enums.Format = &lt;Format.TEXT: 0&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.sql.Placeholder" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> representing a placeholder for query parameters.</p>
<p>If the name is specified, generate a named placeholder (e.g. <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code>,
<code class="docutils literal notranslate"><span class="pre">%(name)b</span></code>), otherwise generate a positional placeholder (e.g. <code class="docutils literal notranslate"><span class="pre">%s</span></code>,
<code class="docutils literal notranslate"><span class="pre">%b</span></code>).</p>
<p>The object is useful to generate SQL queries with a variable number of
arguments.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;insert into table (</span><span class="si">{}</span><span class="s2">) values (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">names</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Placeholder</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">insert into table (&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;) values (%s, %s, %s)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;insert into table (</span><span class="si">{}</span><span class="s2">) values (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">names</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sql</span><span class="o">.</span><span class="n">Placeholder</span><span class="p">,</span> <span class="n">names</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">insert into table (&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;) values (%(foo)s, %(bar)s, %(baz)s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="psycopg3.sql.Composed">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">Composed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>Any<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.sql.Composed" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#psycopg3.sql.Composable" title="psycopg3.sql.Composable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code></a> object made of a sequence of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code>.</p>
<p>The object is usually created using <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> operators and methods.
However it is possible to create a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code> directly specifying a
sequence of objects as arguments: if they are not <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composable</span></code> they will
be wrapped in a <a class="reference internal" href="#psycopg3.sql.Literal" title="psycopg3.sql.Literal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Literal</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Composed</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">sql</span><span class="o">.</span><span class="n">SQL</span><span class="p">(</span><span class="s2">&quot;insert into &quot;</span><span class="p">),</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">insert into &quot;table&quot;</span>
</pre></div>
</div>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code> objects are iterable (so they can be used in <a class="reference internal" href="#psycopg3.sql.SQL.join" title="psycopg3.sql.SQL.join"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL.join</span></code></a> for
instance).</p>
<dl class="py method">
<dt id="psycopg3.sql.Composed.join">
<code class="sig-name descname">join</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">joiner</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference internal" href="#psycopg3.sql.SQL" title="psycopg3.sql.SQL">SQL</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#psycopg3.sql.Composed" title="psycopg3.sql.Composed">psycopg3.sql.Composed</a><a class="headerlink" href="#psycopg3.sql.Composed.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code> interposing the <em>joiner</em> with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Composed</span></code> items.</p>
<p>The <em>joiner</em> must be a <a class="reference internal" href="#psycopg3.sql.SQL" title="psycopg3.sql.SQL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code></a> or a string which will be interpreted as
an <a class="reference internal" href="#psycopg3.sql.SQL" title="psycopg3.sql.SQL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SQL</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fields</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">sql</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>  <span class="c1"># a Composed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">as_string</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
<span class="go">&quot;foo&quot;, &quot;bar&quot;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="utility-functions">
<h2>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="psycopg3.sql.quote">
<code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">quote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="n">context</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><span class="p">, </span>BaseConnection<span class="p">, </span>BaseCursor<span class="p">, </span>Transformer<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a><a class="headerlink" href="#psycopg3.sql.quote" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapt a Python object to a quoted SQL string.</p>
<p>Use this function only if you absolutely want to convert a Python string to
an SQL quoted literal to use e.g. to generate batch SQL and you won’t have
a connection avaliable when you will need to use it.</p>
<p>This function is relatively inefficient, because it doesn’t cache the
adaptation rules. If you pass a <em>context</em> you can adapt the adaptation
rules used, otherwise only global rules are used.</p>
</dd></dl>

<dl class="py data">
<dt id="psycopg3.sql.NULL">
<code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">NULL</code><a class="headerlink" href="#psycopg3.sql.NULL" title="Permalink to this definition">¶</a></dt>
<dt id="psycopg3.sql.DEFAULT">
<code class="sig-prename descclassname">psycopg3.sql.</code><code class="sig-name descname">DEFAULT</code><a class="headerlink" href="#psycopg3.sql.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql.SQL</span></code> objects often useful in queries.</p>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.sql</span></code> – SQL string composition</a><ul>
<li><a class="reference internal" href="#module-usage">Module usage</a></li>
<li><a class="reference internal" href="#sql-objects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql</span></code> objects</a></li>
<li><a class="reference internal" href="#utility-functions">Utility functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cursor.html"
                        title="previous chapter">Cursor classes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="errors.html"
                        title="next chapter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.errors</span></code> – package exceptions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sql.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form class="search" action="search.html" method="get">
  <input type="text" name="q"
   placeholder="type to search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="cursor.html" title="Previous document">Cursor classes</a>
        </li>
        <li>
          <a href="errors.html" title="Next document"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.errors</span></code> – package exceptions</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">psycopg3 UNRELEASED documentation</a></li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; 2020, Daniele Varrazzo and The Psycopg Team.

  </footer>

  
  </body>
</html>
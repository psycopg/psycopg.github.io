<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Prepared statements" href="prepared.html" /><link rel="prev" title="Row factories" href="row-factories.html" />

    <meta name="generator" content="sphinx-3.3.1, furo 2020.11.19.beta18"/>
        <title>Data adaptation configuration - psycopg3 UNRELEASED documentation</title>
      <link rel="stylesheet" href="_static/styles/furo.css?state=6a5bb0a5be5a3055a796a453">
    <link rel="stylesheet" href="_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 1rem;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 1rem;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="_static/pygments_dark.css" />
    <link rel="stylesheet" type="text/css" href="_static/psycopg.css" />
    <link rel="stylesheet" href="_static/styles/furo-extensions.css?state=6a5bb0a5be5a3055a796a453">
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script defer src="_static/jquery.js"></script>
    <script defer src="_static/underscore.js"></script>
    <script defer src="_static/doctools.js"></script>
    <script defer src="_static/language_data.js"></script>
    <script defer src="_static/scripts/main.js?state=6a5bb0a5be5a3055a796a453"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<div class="announcement">
  <aside class="announcement-content">
    <a style="text-decoration: none; color: white;"
   href="https://github.com/sponsors/dvarrazzo/">
   <img height="24px" width="24px" src="/img/logo/psycopg-48.png"/>
    Sponsor psycopg3 on GitHub
</a>

  </aside>
</div>
<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">psycopg3 UNRELEASED documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/psycopg.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/psycopg.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">psycopg3 UNRELEASED documentation</span>
</a><form class="sidebar-search-container" method="get" action="search.html">
  <input class="sidebar-search" placeholder="Search" name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="basic/index.html">Getting started with <code class="docutils literal notranslate"><span class="pre">psycopg3</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Basic module usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="params.html">Passing parameters to SQL queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="adapt-types.html">Adaptation between Python and PostgreSQL types</a></li>
<li class="toctree-l2"><a class="reference internal" href="transactions.html">Transaction management</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="advanced/index.html">Advanced topics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="row-factories.html">Row factories</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Data adaptation configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="prepared.html">Prepared statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="copy.html">Using COPY TO and COPY FROM</a></li>
<li class="toctree-l2"><a class="reference internal" href="async.html">Async operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="cursors.html">Cursor types</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html"><code class="docutils literal notranslate"><span class="pre">psycopg3</span></code> API</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="connection.html">Connection classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="cursor.html">Cursor classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql</span></code> – SQL string composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">errors</span></code> – package exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">types</span></code> – types mapping and adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pq.html"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pq</span></code> – libpq wrapper module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="from_pg2.html">Differences from <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code></a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="data-adaptation-configuration">
<span id="adaptation"></span><h1>Data adaptation configuration<a class="headerlink" href="#data-adaptation-configuration" title="Permalink to this headline">¶</a></h1>
<p>The adaptation system is at the core of psycopg3 and allows to customise the
way Python objects are converted to PostgreSQL when a query is performed and
how PostgreSQL values are converted to Python objects when query results are
returned.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a high-level view of the conversion of types between Python and
PostgreSQL please look at <a class="reference internal" href="params.html#query-parameters"><span class="std std-ref">Passing parameters to SQL queries</span></a>. Using the objects
described in this page is useful if you intend to <em>customise</em> the
adaptation rules.</p>
</div>
<ul class="simple">
<li><p>The <a class="reference internal" href="types.html#psycopg3.types.TypeInfo" title="psycopg3.types.TypeInfo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TypeInfo</span></code></a> object allows to query type information from
a database, which can be used by the adapters: for instance to make them
able to decode arrays of base types or composite types.</p></li>
<li><p>The <a class="reference internal" href="#psycopg3.adapt.Dumper" title="psycopg3.adapt.Dumper"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper</span></code></a> is the base object to perform conversion from a Python object
to a <code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code> string understood by PostgreSQL. The string returned
<em>shouldn’t be quoted</em>: the value will be passed to the database using
functions such as <code class="docutils literal notranslate"><a class="reference external" href="https://www.postgresql.org/docs/13/libpq-exec.html#LIBPQ-PQEXECPARAMS"><span class="pre">PQexecParams</span></a><span class="pre">()</span></code> so quoting and quotes escaping is not
necessary.</p></li>
<li><p>The <a class="reference internal" href="#psycopg3.adapt.Loader" title="psycopg3.adapt.Loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader</span></code></a> is the base object to perform the opposite operation: to read a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code> string from PostgreSQL and create a Python object.</p></li>
</ul>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader</span></code> are abstract classes: concrete classes must implement
the <a class="reference internal" href="#psycopg3.adapt.Dumper.dump" title="psycopg3.adapt.Dumper.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump()</span></code></a> and <a class="reference internal" href="#psycopg3.adapt.Loader.load" title="psycopg3.adapt.Loader.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load()</span></code></a> methods. <code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3</span></code> provides
implementation for several builtin Python and PostgreSQL types.</p>
<p>Psycopg provides adapters for several builtin types, which can be used as the
base to build more complex ones: they all live in the <a class="reference internal" href="types.html#module-psycopg3.types" title="psycopg3.types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3.types</span></code></a>
package.</p>
<div class="section" id="dumpers-and-loaders-configuration">
<h2>Dumpers and loaders configuration<a class="headerlink" href="#dumpers-and-loaders-configuration" title="Permalink to this headline">¶</a></h2>
<p>Dumpers and loaders can be registered on different scopes: globally, per
<a class="reference internal" href="connection.html#psycopg3.Connection" title="psycopg3.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, per <a class="reference internal" href="cursor.html#psycopg3.Cursor" title="psycopg3.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>, so that adaptation rules can
be customised for specific needs within the same application: in order to do
so you can use the <em>context</em> parameter of <a class="reference internal" href="#psycopg3.adapt.Dumper.register" title="psycopg3.adapt.Dumper.register"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper.register()</span></code></a> and
<a class="reference internal" href="#psycopg3.adapt.Loader.register" title="psycopg3.adapt.Loader.register"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader.register()</span></code></a>.</p>
<p>When a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code> is created, it inherits the global adapters
configuration; when a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code> is created it inherits its <code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code>
configuration.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register()</span></code> is a class method on the base class, so if you
subclass <code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader</span></code> you should call the <code class="docutils literal notranslate"><span class="pre">.register()</span></code> on the
class you created.</p>
</div>
<div class="admonition-todo admonition">
<p class="admonition-title">TODO</p>
<ul class="simple">
<li><p>Example: infinity date customisation</p></li>
<li><p>Example: numeric to float</p></li>
</ul>
</div>
</div>
<div class="section" id="dumpers-and-loaders-life-cycle">
<h2>Dumpers and loaders life cycle<a class="headerlink" href="#dumpers-and-loaders-life-cycle" title="Permalink to this headline">¶</a></h2>
<p>Registering dumpers and loaders will instruct <code class="xref py py-obj docutils literal notranslate"><span class="pre">psycopg3</span></code> to use them
in the queries to follow, in the context where they have been registered.</p>
<p>When a query is performed on a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code>, a <a class="reference internal" href="#psycopg3.adapt.Transformer" title="psycopg3.adapt.Transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code></a> object is created
as a local context to manage conversions during the query, instantiating the
required dumpers and loaders and dispatching the values to convert to the
right instance.</p>
<ul class="simple">
<li><p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">Trasformer</span></code> copies the adapters configuration from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code>, thus
inheriting all the changes made to the global configuration, the current
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code>, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code>.</p></li>
<li><p>For every Python type passed as query argument, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code> will
instantiate a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper</span></code>. Usually all the objects of the same type will be
converted by the same dumper; certain dumpers may be used in more than one
instance, because the same Python type maps to more than one PostgreSQL type
(for instance, a Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a> might be better dumped as a PostgreSQL
<code class="sql docutils literal notranslate"><span class="pre">integer</span></code>, <code class="sql docutils literal notranslate"><span class="pre">bigint</span></code>, <code class="sql docutils literal notranslate"><span class="pre">smallint</span></code> according to its value).</p></li>
<li><p>For every OID returned by the query, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code> will instantiate a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader</span></code>. All the values with the same OID will be converted by the same
loader.</p></li>
<li><p>Recursive types (e.g. Python lists, PostgreSQL arrays and composite types)
will use the same adaptation rules.</p></li>
</ul>
<p>As a consequence it is possible to perform certain choices only once per query
(e.g. looking up the connection encoding) and then call a fast-path operation
for each value to convert.</p>
<p>Querying will fail if a Python object for which there isn’t a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper</span></code>
registered (for the right <a class="reference internal" href="pq.html#psycopg3.pq.Format" title="psycopg3.pq.Format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Format</span></code></a>) is used as query parameter.
If the query returns a data type whose OID doesn’t have a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader</span></code>, the
value will be returned as a string (or bytes string for binary types).</p>
</div>
<div class="section" id="objects-involved-in-types-adaptation">
<h2>Objects involved in types adaptation<a class="headerlink" href="#objects-involved-in-types-adaptation" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition">
<p class="admonition-title">TODO</p>
<p>move to API section</p>
</div>
<dl class="py class">
<dt id="psycopg3.adapt.Format">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.adapt.</code><code class="sig-name descname">Format</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.adapt.Format" title="Permalink to this definition">¶</a></dt>
<dd><p>Enum representing the format wanted for a query argument.</p>
<p>The value <a class="reference internal" href="#psycopg3.adapt.Format.AUTO" title="psycopg3.adapt.Format.AUTO"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AUTO</span></code></a> allows psycopg3 to choose the best value for a certain
value.</p>
<dl class="py attribute">
<dt id="psycopg3.adapt.Format.AUTO">
<code class="sig-name descname">AUTO</code><em class="property"> = 's'</em><a class="headerlink" href="#psycopg3.adapt.Format.AUTO" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically chosen (<code class="docutils literal notranslate"><span class="pre">%s</span></code> placeholder).</p>
</dd></dl>
<dl class="py attribute">
<dt id="psycopg3.adapt.Format.TEXT">
<code class="sig-name descname">TEXT</code><em class="property"> = 't'</em><a class="headerlink" href="#psycopg3.adapt.Format.TEXT" title="Permalink to this definition">¶</a></dt>
<dd><p>Text parameter (<code class="docutils literal notranslate"><span class="pre">%t</span></code> placeholder).</p>
</dd></dl>
<dl class="py attribute">
<dt id="psycopg3.adapt.Format.BINARY">
<code class="sig-name descname">BINARY</code><em class="property"> = 'b'</em><a class="headerlink" href="#psycopg3.adapt.Format.BINARY" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary parameter (<code class="docutils literal notranslate"><span class="pre">%b</span></code> placeholder).</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt id="psycopg3.adapt.Dumper">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.adapt.</code><code class="sig-name descname">Dumper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls</span></em>, <em class="sig-param"><span class="n">context</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.adapt.Dumper" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Python object of the type <em>cls</em> to PostgreSQL representation.</p>
<p>This is an abstract base class: subclasses <em>must</em> implement the <a class="reference internal" href="#psycopg3.adapt.Dumper.dump" title="psycopg3.adapt.Dumper.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump()</span></code></a>
method and specify the <a class="reference internal" href="#psycopg3.adapt.Dumper.format" title="psycopg3.adapt.Dumper.format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">format</span></code></a>.
They <em>may</em> implement <a class="reference internal" href="#psycopg3.adapt.Dumper.oid" title="psycopg3.adapt.Dumper.oid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">oid</span></code></a> (as attribute or property) in order to
override the oid type oid; if not PostgreSQL will try to infer the type
from the context, but this may fail in some contexts and may require a
cast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – The type that will be managed by this dumper.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="connection.html#psycopg3.Connection" title="psycopg3.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor" title="psycopg3.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>, or <a class="reference internal" href="#psycopg3.adapt.Transformer" title="psycopg3.adapt.Transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code></a>) – The context where the transformation is performed. If not
specified the conversion might be inaccurate, for instance it will not
be possible to know the connection encoding or the server date format.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="psycopg3.adapt.Dumper.format">
<code class="sig-name descname">format</code><em class="property">: pq.Format</em><a class="headerlink" href="#psycopg3.adapt.Dumper.format" title="Permalink to this definition">¶</a></dt>
<dd><p>The format this class dumps, <a class="reference internal" href="#psycopg3.adapt.Format.TEXT" title="psycopg3.adapt.Format.TEXT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TEXT</span></code></a> or <a class="reference internal" href="#psycopg3.adapt.Format.BINARY" title="psycopg3.adapt.Format.BINARY"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BINARY</span></code></a>.
This is a class attribute.</p>
</dd></dl>
<dl class="py method">
<dt id="psycopg3.adapt.Dumper.dump">
<em class="property">abstract </em><code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> → Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)">bytes</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytearray" title="(in Python v3.9)">bytearray</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(in Python v3.9)">memoryview</a><span class="p">]</span><a class="headerlink" href="#psycopg3.adapt.Dumper.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the object <em>obj</em> to PostgreSQL representation.</p>
<p>The format returned by dump shouldn’t contain quotes or escaped
values.</p>
</dd></dl>
<dl class="py method">
<dt id="psycopg3.adapt.Dumper.quote">
<code class="sig-name descname">quote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> → Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)">bytes</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytearray" title="(in Python v3.9)">bytearray</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(in Python v3.9)">memoryview</a><span class="p">]</span><a class="headerlink" href="#psycopg3.adapt.Dumper.quote" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the object <em>obj</em> to escaped representation.</p>
<p>By default return the <a class="reference internal" href="#psycopg3.adapt.Dumper.dump" title="psycopg3.adapt.Dumper.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump()</span></code></a> value quoted and sanitised, so
that the result can be used to build a SQL string. This works well
for most types and you won’t likely have to implement this method in a
subclass.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will be used by <a class="reference internal" href="sql.html#psycopg3.sql.Literal" title="psycopg3.sql.Literal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Literal</span></code></a> to convert a
value client-side.</p>
</div>
<p>This method only makes sense for text dumpers; the result of calling
it on a binary dumper is undefined. It might scratch your car, or burn
your cake. Don’t tell me I didn’t warn you.</p>
</dd></dl>
<dl class="py attribute">
<dt id="psycopg3.adapt.Dumper.oid">
<code class="sig-name descname">oid</code><em class="property"> int</em><a class="headerlink" href="#psycopg3.adapt.Dumper.oid" title="Permalink to this definition">¶</a></dt>
<dd><p>The oid to pass to the server, if known.</p>
<div class="admonition-todo admonition">
<p class="admonition-title">todo</p>
<p>Document how to find type OIDs in a database.</p>
</div>
</dd></dl>
<dl class="py method">
<dt id="psycopg3.adapt.Dumper.register">
<em class="property">classmethod </em><code class="sig-name descname">register</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls</span></em>, <em class="sig-param"><span class="n">context</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.adapt.Dumper.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure <em>context</em> to use this dumper to convert object of type <em>cls</em>.</p>
<p>You should call this method on the <a class="reference internal" href="#psycopg3.adapt.Dumper" title="psycopg3.adapt.Dumper"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dumper</span></code></a> subclass you create,
passing the Python type you want to dump as <em>cls</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The type to manage.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="connection.html#psycopg3.Connection" title="psycopg3.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor" title="psycopg3.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>, or <a class="reference internal" href="#psycopg3.adapt.Transformer" title="psycopg3.adapt.Transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code></a>) – Where the dumper should be used. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> the dumper
will be used globally.</p></li>
</ul>
</dd>
</dl>
<p>If <em>cls</em> is specified as string it will be lazy-loaded, so that it
will be possible to register it without importing it before. In this
case it should be the fully qualified name of the object (e.g.
<code class="docutils literal notranslate"><span class="pre">"uuid.UUID"</span></code>).</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt id="psycopg3.adapt.Loader">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.adapt.</code><code class="sig-name descname">Loader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">oid</span></em>, <em class="sig-param"><span class="n">context</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.adapt.Loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert PostgreSQL objects with OID <em>oid</em> to Python objects.</p>
<p>This is an abstract base class: subclasses <em>must</em> implement the <a class="reference internal" href="#psycopg3.adapt.Loader.load" title="psycopg3.adapt.Loader.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load()</span></code></a>
method and specify a <a class="reference internal" href="#psycopg3.adapt.Loader.format" title="psycopg3.adapt.Loader.format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">format</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The type that will be managed by this dumper.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="connection.html#psycopg3.Connection" title="psycopg3.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor" title="psycopg3.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>, or <a class="reference internal" href="#psycopg3.adapt.Transformer" title="psycopg3.adapt.Transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code></a>) – The context where the transformation is performed. If not
specified the conversion might be inaccurate, for instance it will not
be possible to know the connection encoding or the server date format.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="psycopg3.adapt.Loader.format">
<code class="sig-name descname">format</code><em class="property">: <a class="reference internal" href="#psycopg3.adapt.Format" title="psycopg3.adapt.Format">Format</a></em><a class="headerlink" href="#psycopg3.adapt.Loader.format" title="Permalink to this definition">¶</a></dt>
<dd><p>The format this class can load, <a class="reference internal" href="#psycopg3.adapt.Format.TEXT" title="psycopg3.adapt.Format.TEXT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TEXT</span></code></a> or <a class="reference internal" href="#psycopg3.adapt.Format.BINARY" title="psycopg3.adapt.Format.BINARY"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BINARY</span></code></a>.
This is a class attribute.</p>
</dd></dl>
<dl class="py method">
<dt id="psycopg3.adapt.Loader.load">
<em class="property">abstract </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)">bytes</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytearray" title="(in Python v3.9)">bytearray</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(in Python v3.9)">memoryview</a><span class="p">]</span></span></em><span class="sig-paren">)</span> → Any<a class="headerlink" href="#psycopg3.adapt.Loader.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a PostgreSQL value to a Python object.</p>
</dd></dl>
<dl class="py method">
<dt id="psycopg3.adapt.Loader.register">
<em class="property">classmethod </em><code class="sig-name descname">register</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">oid</span></em>, <em class="sig-param"><span class="n">context</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.adapt.Loader.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure <em>context</em> to use this loader to convert values with OID <em>oid</em>.</p>
<p>You should call this method on the <a class="reference internal" href="#psycopg3.adapt.Loader" title="psycopg3.adapt.Loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Loader</span></code></a> subclass you create,
passing the OID of the type you want to load as <em>oid</em> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oid</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The PostgreSQL OID to manage.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="connection.html#psycopg3.Connection" title="psycopg3.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor" title="psycopg3.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>, or <a class="reference internal" href="#psycopg3.adapt.Transformer" title="psycopg3.adapt.Transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code></a>) – Where the loader should be used. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code> the loader
will be used globally.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt id="psycopg3.adapt.Transformer">
<em class="property">class </em><code class="sig-prename descclassname">psycopg3.adapt.</code><code class="sig-name descname">Transformer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">context</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psycopg3.adapt.Transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>An object that can adapt efficiently between Python and PostgreSQL.</p>
<p>The life cycle of the object is the query, so it is assumed that stuff like
the server version or connection encoding will not change. It can have its
state so adapting several values of the same type can be optimised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>context</strong> (<a class="reference internal" href="connection.html#psycopg3.Connection" title="psycopg3.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="cursor.html#psycopg3.Cursor" title="psycopg3.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>, or <a class="reference internal" href="#psycopg3.adapt.Transformer" title="psycopg3.adapt.Transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transformer</span></code></a>) – The context where the transformer should operate.</p>
</dd>
</dl>
<p>TODO: finalise the interface of this object</p>
</dd></dl>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="prepared.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Prepared statements</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="row-factories.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Row factories</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2020-2021, Daniele Varrazzo and The Psycopg Team
            |
            <a class="muted-link" href="_sources/adaptation.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Data adaptation configuration</a><ul>
<li><a class="reference internal" href="#dumpers-and-loaders-configuration">Dumpers and loaders configuration</a></li>
<li><a class="reference internal" href="#dumpers-and-loaders-life-cycle">Dumpers and loaders life cycle</a></li>
<li><a class="reference internal" href="#objects-involved-in-types-adaptation">Objects involved in types adaptation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div>
  </body>
</html>